<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ExpTech Studio Weather Map</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/maplibre-gl/5.0.0/maplibre-gl.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/maplibre-gl/5.0.0/maplibre-gl.css" rel="stylesheet">
    <link href="./css/radar.css" rel="stylesheet">
    <link href="./css/color.css" rel="stylesheet">
    <link href="./css/layer.css" rel="stylesheet">
    <link href="./css/time-selector.css" rel="stylesheet">
    <link href="./css/chart.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="./js/nav.js" defer></script>
</head>

<body>

    <div id="map"></div>
    <div id="timebar-row">
        <div id="time-display" style="cursor:pointer;"></div>
        <div id="radar-play-controls"></div>
    </div>

    <button id="reset-position">
        <svg width="20" height="20" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--gis" preserveAspectRatio="xMidYMid meet">
            <path d="M43 0v13.166C27.944 16.03 16.03 27.944 13.166 43H0v14h13.166C16.03 72.056 27.944 83.97 43 86.834V100h14V86.834C72.056 83.97 83.97 72.056 86.834 57H100V43H86.834C83.97 27.944 72.056 16.03 57 13.166V0H43zm7 22.5A27.425 27.425 0 0 1 77.5 50A27.425 27.425 0 0 1 50 77.5A27.425 27.425 0 0 1 22.5 50A27.425 27.425 0 0 1 50 22.5z" fill="currentColor"></path>
            <circle r="15" cy="50" cx="50" fill="currentColor"></circle>
        </svg>
    </button>

    <button id="toggle-layer">
        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3">
            <path d="M480-118 120-398l66-50 294 228 294-228 66 50-360 280Zm0-202L120-600l360-280 360 280-360 280Zm0-280Zm0 178 230-178-230-178-230 178 230 178Z"/>
        </svg>
    </button>

    <div id="chart-popup" class="chart-popup" data-station-id="" data-station-name="">
        <div class="chart-popup-content">
            <div class="chart-header">
                <div class="chart-header-left">
                    <h3 id="chart-title">載入中…</h3>
                </div>
                <div class="chart-header-right">
                    <select id="chart-type-select" aria-label="切換圖表">
                        <option value="temperature" selected>氣溫</option>
                        <option value="wind">風向/風速</option>
                        <option value="rain">雨量</option>
                        <option value="humidity">濕度</option>
                        <option value="pressure">氣壓</option>
                        <option value="all">全部</option>
                    </select>
                    <select id="chart-duration-select" aria-label="選擇時長">
                        <option value="6" selected>6 小時</option>
                        <option value="12">12 小時</option>
                        <option value="24">24 小時</option>
                        <option value="all">全部</option>
                    </select>
                    <!-- Rain interval selector: shown only when chart type is 'rain' -->
                    <select id="rain-interval-select" aria-label="選擇雨量統計時段">
                        <option value="now" selected>現在</option>
                        <option value="10m">10 分鐘</option>
                        <option value="1h">1 小時</option>
                        <option value="3h">3 小時</option>
                        <option value="6h">6 小時</option>
                        <option value="12h">12 小時</option>
                        <option value="24h">24 小時</option>
                        <option value="2d">2 天</option>
                        <option value="3d">3 天</option>
                    </select>
                    <span class="chart-close-button" aria-label="關閉">&times;</span>
                </div>
            </div>
            <div id="progress-container">
                <div id="progress-bar">0%</div>
            </div>
            <canvas id="temperature-chart"></canvas>
            <canvas id="wind-chart"></canvas>
            <canvas id="rain-chart"></canvas>
            <canvas id="humidity-chart"></canvas>
            <canvas id="pressure-chart"></canvas>
            <canvas id="all-chart"></canvas>
        </div>
    </div>

    <script src="./js/globals.js"></script>
    <script src="./js/map.js"></script>
    <script src="./js/layer.js"></script>
    <script src="./js/weather/radar.js"></script>
    <script src="./js/weather/radarRain.js"></script>
    <script src="./js/weather/rain.js"></script>
    <script src="./js/weather/temperature.js"></script>
    <script src="./js/weather/temphigh.js"></script>
    <script src="./js/weather/templow.js"></script>
    <script src="./js/weather/tempDiff.js"></script>
    <script src="./js/weather/humidity.js"></script>
    <script src="./js/weather/pressure.js"></script>
    <script src="./js/weather/wind.js"></script>
    <script src="./js/weather/lightning.js"></script>
    <script src="./js/time-selector.js" defer></script>
    <script src="./js/weather/allchart.js" defer></script>
</body>
</html>